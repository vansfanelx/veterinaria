<div class="appointment-detail-container">
  @if (loading) {
    <div class="loading">Cargando...</div>
  }

  @if (error) {
    <div class="alert alert-error">{{ error }}</div>
  }

  @if (appointment && !loading) {
    <div class="detail-header">
      <div>
        <h1>Detalle de Cita</h1>
        <span class="status-badge" [ngClass]="getStatusClass(appointment.status)">
          {{ getStatusLabel(appointment.status) }}
        </span>
      </div>
      <div class="actions">
        <a routerLink="/appointments" class="btn btn-secondary">← Volver</a>
        <a [routerLink]="['/appointments', appointment.id, 'edit']" class="btn btn-warning">Editar</a>
        <button (click)="openDeleteModal()" class="btn btn-danger">Eliminar</button>
      </div>
    </div>

    <div class="detail-content">
      <div class="info-section">
        <h2>Información de la Cita</h2>
        <div class="info-grid">
          <div class="info-item">
            <label>ID:</label>
            <span>{{ appointment.id }}</span>
          </div>
          <div class="info-item">
            <label>Fecha y Hora:</label>
            <span>{{ appointment.date | date:'dd/MM/yyyy' }} {{ appointment.time }}</span>
          </div>
          <div class="info-item">
            <label>Estado:</label>
            <span class="status-badge" [ngClass]="getStatusClass(appointment.status)">
              {{ getStatusLabel(appointment.status) }}
            </span>
          </div>
        </div>
      </div>

      <div class="info-section">
        <h2>Mascota</h2>
        <div class="info-grid">
          <div class="info-item">
            <label>Nombre:</label>
            <span>{{ appointment.pet?.name || 'N/A' }}</span>
          </div>
          <div class="info-item">
            <label>Especie:</label>
            <span>{{ appointment.pet?.species || 'N/A' }}</span>
          </div>
        </div>
        @if (appointment.pet?.id) {
          <a [routerLink]="['/pets', appointment.pet!.id]" class="btn btn-sm btn-info">
            Ver detalles de la mascota
          </a>
        }
      </div>

      <div class="info-section">
        <h2>Detalles de la Consulta</h2>
        <div class="info-item full-width">
          <label>Motivo:</label>
          <p>{{ appointment.reason }}</p>
        </div>
        @if (appointment.notes) {
          <div class="info-item full-width">
            <label>Notas:</label>
            <p>{{ appointment.notes }}</p>
          </div>
        }
      </div>

      <div class="info-section">
        <h2>Información Adicional</h2>
        <div class="info-grid">
          <div class="info-item">
            <label>Fecha de creación:</label>
            <span>{{ appointment.created_at | date:'dd/MM/yyyy HH:mm' }}</span>
          </div>
          <div class="info-item">
            <label>Última actualización:</label>
            <span>{{ appointment.updated_at | date:'dd/MM/yyyy HH:mm' }}</span>
          </div>
        </div>
      </div>
    </div>
  }
</div>

<!-- Modal de confirmación de eliminación -->
<app-confirm-modal
  [isOpen]="showDeleteModal"
  [title]="'Confirmar eliminación'"
  [message]="'¿Está seguro de eliminar esta cita? Esta acción no se puede deshacer.'"
  [confirmText]="'Eliminar'"
  [cancelText]="'Cancelar'"
  [type]="'danger'"
  (confirm)="confirmDelete()"
  (cancel)="closeDeleteModal()">
</app-confirm-modal>
