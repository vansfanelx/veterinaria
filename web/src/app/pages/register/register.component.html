<div class="register-page">
  <div class="register-container">
    <div class="register-card">
      <div class="register-header">
        <div class="logo">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C9.243 2 7 4.243 7 7c0 1.447.619 2.746 1.601 3.66-.421.247-.816.547-1.174.897C6.234 12.75 5.5 14.558 5.5 16.5c0 2.2 1.2 4 3 4.5.3.1.5.3.5.6v1.4c0 .6.4 1 1 1h4c.6 0 1-.4 1-1v-1.4c0-.3.2-.5.5-.6 1.8-.5 3-2.3 3-4.5 0-1.942-.734-3.75-1.927-4.943-.358-.35-.753-.65-1.174-.897C16.381 9.746 17 8.447 17 7c0-2.757-2.243-5-5-5zm0 2c1.654 0 3 1.346 3 3s-1.346 3-3 3-3-1.346-3-3 1.346-3 3-3z"/>
          </svg>
        </div>
        <h1>Crear Cuenta</h1>
        <p>Regístrate para agendar citas para tu mascota</p>
      </div>

      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
        <div class="form-row">
          <div class="form-group">
            <label for="name">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
              Nombre Completo
            </label>
            <input
              type="text"
              id="name"
              formControlName="name"
              placeholder="Juan Pérez"
              [class.error]="registerForm.get('name')?.touched && registerForm.get('name')?.invalid"
            />
            @if (getErrorMessage('name')) {
              <span class="error-message">{{ getErrorMessage('name') }}</span>
            }
          </div>

          <div class="form-group">
            <label for="email">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                <polyline points="22,6 12,13 2,6"></polyline>
              </svg>
              Correo Electrónico
            </label>
            <input
              type="email"
              id="email"
              formControlName="email"
              placeholder="tu@ejemplo.com"
              [class.error]="registerForm.get('email')?.touched && registerForm.get('email')?.invalid"
            />
            @if (getErrorMessage('email')) {
              <span class="error-message">{{ getErrorMessage('email') }}</span>
            }
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="phone">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
              </svg>
              Teléfono
            </label>
            <input
              type="tel"
              id="phone"
              formControlName="phone"
              placeholder="987654321"
              maxlength="9"
              [class.error]="registerForm.get('phone')?.touched && registerForm.get('phone')?.invalid"
            />
            @if (getErrorMessage('phone')) {
              <span class="error-message">{{ getErrorMessage('phone') }}</span>
            }
          </div>

          <div class="form-group">
            <label for="address">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                <circle cx="12" cy="10" r="3"></circle>
              </svg>
              Dirección
            </label>
            <input
              type="text"
              id="address"
              formControlName="address"
              placeholder="Calle Principal #123"
              [class.error]="registerForm.get('address')?.touched && registerForm.get('address')?.invalid"
            />
            @if (getErrorMessage('address')) {
              <span class="error-message">{{ getErrorMessage('address') }}</span>
            }
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="password">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
              </svg>
              Contraseña
            </label>
            <div class="password-input">
              <input
                [type]="showPassword ? 'text' : 'password'"
                id="password"
                formControlName="password"
                placeholder="••••••••"
                [class.error]="registerForm.get('password')?.touched && registerForm.get('password')?.invalid"
              />
              <button type="button" class="toggle-password" (click)="togglePassword()">
                @if (showPassword) {
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                    <line x1="1" y1="1" x2="23" y2="23"></line>
                  </svg>
                } @else {
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg>
                }
              </button>
            </div>
            @if (getErrorMessage('password')) {
              <span class="error-message">{{ getErrorMessage('password') }}</span>
            }
          </div>

          <div class="form-group">
            <label for="password_confirmation">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
              </svg>
              Confirmar Contraseña
            </label>
            <div class="password-input">
              <input
                [type]="showConfirmPassword ? 'text' : 'password'"
                id="password_confirmation"
                formControlName="password_confirmation"
                placeholder="••••••••"
                [class.error]="registerForm.get('password_confirmation')?.touched && (registerForm.get('password_confirmation')?.invalid || registerForm.errors?.['passwordMismatch'])"
              />
              <button type="button" class="toggle-password" (click)="toggleConfirmPassword()">
                @if (showConfirmPassword) {
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                    <line x1="1" y1="1" x2="23" y2="23"></line>
                  </svg>
                } @else {
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg>
                }
              </button>
            </div>
            @if (getErrorMessage('password_confirmation')) {
              <span class="error-message">{{ getErrorMessage('password_confirmation') }}</span>
            }
          </div>
        </div>

        <div class="captcha-section">
          <app-captcha (verified)="onCaptchaVerified($event)"></app-captcha>
        </div>

        <button type="submit" class="btn-submit" [disabled]="isLoading || !captchaToken">
          @if (isLoading) {
            <svg class="spinner" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Creando cuenta...
          } @else {
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <line x1="19" y1="8" x2="19" y2="14"></line>
              <line x1="22" y1="11" x2="16" y2="11"></line>
            </svg>
            Crear Cuenta
          }
        </button>
      </form>

      <div class="register-footer">
        <p>¿Ya tienes una cuenta? <a routerLink="/login">Inicia sesión aquí</a></p>
      </div>
    </div>
  </div>
</div>
